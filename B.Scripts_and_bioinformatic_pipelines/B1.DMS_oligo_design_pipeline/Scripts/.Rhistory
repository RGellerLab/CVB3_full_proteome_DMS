########
## trims overlaps for hifi and then align/translate
library(Biostrings)
library(tidyverse)
library(readxl)
library(DECIPHER)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DECIPHER")
########
## trims overlaps for hifi and then align/translate
library(Biostrings)
library(tidyverse)
library(readxl)
library(DECIPHER)
###Read ORF
seq<-readDNAStringSet("./CVB3_nancy.fa")
output.dir="./Alignments/"
dir.create(output.dir,showWarnings = F)
###Read tile and overlaps coordinates
coord<-data.frame(read_xlsx("./Tiles_overlaps_coord.xlsx"))
tiles.seq<-data.frame("index"=character(), "overlap_5"=character(), "ref_seq"=character(), "overlap_3"=character(), "start_aa"=character())
tiles.seq=bind_cols(X5_start=coord$X5_start,
X5_end=coord$X5_end,
X3_start=coord$X3_start,
X3_end=coord$X3_end)
for (i in 1:10){
# i=1
rg=readDNAStringSet(paste0("./Oligos/Tile_", i+8,"_oligos.fa"))
x5=as.character(subseq(seq,start = tiles.seq$X5_start[i],tiles.seq$X5_end[i]))
x3=as.character(subseq(seq,start = tiles.seq$X3_start[i],tiles.seq$X3_end[i]))
rg=trimLRPatterns(Lpattern = x5,Rpattern = x3,rg)
ref2=subseq(seq,tiles.seq$X5_end[i]+1,tiles.seq$X3_start[i]-1)
rg=c(ref2,rg)
aarg=translate(rg)
rg=AlignTranslation(rg)
writeXStringSet(rg,paste0(output.dir, "tile_",i+8,"_trim_align.fa"))
writeXStringSet( aarg,paste0(output.dir, "tile_",i+8,"_AA_trim_align.fa"))
# rm(x5,x3,,rg,i,aarg)
}
